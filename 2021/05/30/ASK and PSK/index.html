<!DOCTYPE html>


<html lang="en">


<head>
  <meta name="google-site-verification" content="QbUVAi0K2ZB_P4A6jbbi-GVB4BXs3n6GqgIEGHlySnk" />
  <meta charset="utf-8" />
   
  <meta name="keywords" content="Torch, Summary, UAV, Git" />
   
  <meta name="description" content="No fear of words,no fear of years" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
  <title>
    ASK and PSK |  Haisenberg
  </title>
  <meta name="generator" content="hexo-theme-ayer">
  
  <link rel="shortcut icon" href="/favicon.ico" />
  
  
<link rel="stylesheet" href="/dist/main.css">

  <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/Shen-Yu/cdn/css/remixicon.min.css">
  
<link rel="stylesheet" href="/css/custom.css">

  
  <script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script>
  
  

  


<style>.github-emoji { position: relative; display: inline-block; width: 1.2em; min-height: 1.2em; overflow: hidden; vertical-align: top; color: transparent; }  .github-emoji > span { position: relative; z-index: 10; }  .github-emoji img, .github-emoji .fancybox { margin: 0 !important; padding: 0 !important; border: none !important; outline: none !important; text-decoration: none !important; user-select: none !important; cursor: auto !important; }  .github-emoji img { height: 1.2em !important; width: 1.2em !important; position: absolute !important; left: 50% !important; top: 50% !important; transform: translate(-50%, -50%) !important; user-select: none !important; cursor: auto !important; } .github-emoji-fallback { color: inherit; } .github-emoji-fallback img { opacity: 0 !important; }</style>
<link rel="alternate" href="/atom.xml" title="Haisenberg" type="application/atom+xml">
</head>

</html>

<body>
  <div id="app">
    
      
    <main class="content on">
      <section class="outer">
  <article
  id="post-ASK and PSK"
  class="article article-type-post"
  itemscope
  itemprop="blogPost"
  data-scroll-reveal
>
  <div class="article-inner">
    
    <header class="article-header">
       
<h1 class="article-title sea-center" style="border-left:0" itemprop="name">
  ASK and PSK
</h1>
 

    </header>
     
    <div class="article-meta">
      <a href="/2021/05/30/ASK%20and%20PSK/" class="article-date">
  <time datetime="2021-05-30T00:00:00.000Z" itemprop="datePublished">2021-05-30</time>
</a> 
  <div class="article-category">
    <a class="article-category-link" href="/categories/Communication/">Communication</a>
  </div>
  
<div class="word_count">
    <span class="post-time">
        <span class="post-meta-item-icon">
            <i class="ri-quill-pen-line"></i>
            <span class="post-meta-item-text"> Word count:</span>
            <span class="post-count">2.3k</span>
        </span>
    </span>

    <span class="post-time">
        &nbsp; | &nbsp;
        <span class="post-meta-item-icon">
            <i class="ri-book-open-line"></i>
            <span class="post-meta-item-text"> Reading time‚âà</span>
            <span class="post-count">14 min</span>
        </span>
    </span>
</div>
 
    </div>
      
    <div class="tocbot"></div>




  
    <div class="article-entry" itemprop="articleBody">
       
  <p><span class="github-emoji"><span>üìå</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4cc.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p>
<h3 id="Most-communication-channels-have-communication-channels-so-the-only-way-to-transmit-signals-through-such-channels-is-to-move-the-fortunate-frequency-that-carries-the-message-to-the-frequency-band-of-the-channel"><a href="#Most-communication-channels-have-communication-channels-so-the-only-way-to-transmit-signals-through-such-channels-is-to-move-the-fortunate-frequency-that-carries-the-message-to-the-frequency-band-of-the-channel" class="headerlink" title="Most communication channels have communication channels, so the only way to transmit signals through such channels is to move the fortunate frequency that carries the message to the frequency band of the channel"></a>Most communication channels have communication channels, so the only way to transmit signals through such channels is to move the fortunate frequency that carries the message to the frequency band of the channel</h3><p><span class="github-emoji"><span>‚òÄ</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/2600.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><span class="github-emoji"><span>üï£</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f563.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span><span class="github-emoji"><span>üò¥</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f634.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span></p>
<span id="more"></span>
<hr>
<h2 id="notebook-4ASK"><a href="#notebook-4ASK" class="headerlink" title=":notebook: 4ASK"></a><span class="github-emoji"><span>üìì</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4d3.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 4ASK</h2><h3 id="u-m-t-A-m-g-T-t-cos-2-pi-f-c-t-m-1-2-3-‚Ä¶-M"><a href="#u-m-t-A-m-g-T-t-cos-2-pi-f-c-t-m-1-2-3-‚Ä¶-M" class="headerlink" title="$u{m}(t) = A{m}g{T}(t)cos(2\pi f{c}t),m=1,2,3,‚Ä¶,M$"></a>$u<em>{m}(t) = A</em>{m}g<em>{T}(t)cos(2\pi f</em>{c}t),m=1,2,3,‚Ä¶,M$</h3><h3 id="A-m-2m-1-M-d-m-1-2-3-‚Ä¶-M"><a href="#A-m-2m-1-M-d-m-1-2-3-‚Ä¶-M" class="headerlink" title="$A_{m}=(2m-1-M)d,m=1,2,3,‚Ä¶,M$"></a>$A_{m}=(2m-1-M)d,m=1,2,3,‚Ä¶,M$</h3><p>$ g_{T}(t)=<br>  \begin{cases}<br>  \sqrt\frac 2T, 0‚â§t‚â§T \\<br>  0, otherwise \\<br>  \end{cases} $</p>
<p><em>Where d=1, T=1, fc=5Hz, the mapping rule from the bit pair to m is: 00-&gt;1, 01-&gt;2,11-&gt;3,10-&gt;4.<br>(1) If the message bits are 11 00 10 00 01, plot the corresponding 4ASK signal in both time and frequency domain, sampling frequency fs=1000Hz.<br>(2) Give the average signal energy per bit, i.e., Eb, for 4ASK.<br>(3) Denote SNR as Eb/N0, plot the theoretical SER (symbol error rate) and simulated SER, for SNR=0:2:8 dB.</em></p>
<h3 id="memo-4ASK-Code"><a href="#memo-4ASK-Code" class="headerlink" title=":memo: 4ASK Code"></a><span class="github-emoji"><span>üìù</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4dd.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 4ASK Code</h3><ul>
<li>4ASK.m</li>
</ul>
<figure class="highlight matlab"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% Consider the following 4ASK modulation, where T=1.</span></span><br><span class="line"> </span><br><span class="line">clear;</span><br><span class="line">clc;</span><br><span class="line"> </span><br><span class="line"><span class="comment">%% Task(1)</span></span><br><span class="line"><span class="comment">% Plot the corresponding 4ASK signal.</span></span><br><span class="line">T = <span class="number">1</span>;                  <span class="comment">% Symbol interval.</span></span><br><span class="line">d = <span class="number">1</span>;</span><br><span class="line">Tb = T/<span class="number">2</span>;               <span class="comment">% Bit interval.</span></span><br><span class="line">m = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>];          <span class="comment">% Equally spaced.</span></span><br><span class="line">M = <span class="number">4</span>;                  <span class="comment">% 4ASK:M=4</span></span><br><span class="line">A_m = (<span class="number">2</span>*m<span class="number">-1</span>-M)*d;      <span class="comment">% The amplitude of the m-th waveform.</span></span><br><span class="line">fc = <span class="number">5</span>;                 <span class="comment">% Carrier frequency.</span></span><br><span class="line">fs = <span class="number">1000</span>;              <span class="comment">% Sampling frequency.</span></span><br><span class="line">gT=<span class="built_in">sqrt</span>(<span class="number">2</span>/T);           <span class="comment">% Transmission pulse.</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">% Message bits.</span></span><br><span class="line">N = <span class="number">5</span>;</span><br><span class="line">Sig = [<span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span>];</span><br><span class="line"><span class="comment">% Mapping.</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">2</span>:<span class="built_in">length</span>(Sig)</span><br><span class="line">    <span class="keyword">if</span>(Sig(<span class="built_in">i</span>)==<span class="number">0</span>&amp;&amp;Sig(<span class="built_in">i</span>+<span class="number">1</span>)==<span class="number">0</span>)</span><br><span class="line">        m(<span class="built_in">fix</span>(<span class="built_in">i</span>/<span class="number">2</span>)+<span class="number">1</span>) = A_m(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">elseif</span>(Sig(<span class="built_in">i</span>)==<span class="number">0</span>&amp;&amp;Sig(<span class="built_in">i</span>+<span class="number">1</span>)==<span class="number">1</span>)</span><br><span class="line">        m(<span class="built_in">fix</span>(<span class="built_in">i</span>/<span class="number">2</span>)+<span class="number">1</span>) = A_m(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">elseif</span>(Sig(<span class="built_in">i</span>)==<span class="number">1</span>&amp;&amp;Sig(<span class="built_in">i</span>+<span class="number">1</span>)==<span class="number">1</span>)</span><br><span class="line">        m(<span class="built_in">fix</span>(<span class="built_in">i</span>/<span class="number">2</span>)+<span class="number">1</span>) = A_m(<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        m(<span class="built_in">fix</span>(<span class="built_in">i</span>/<span class="number">2</span>)+<span class="number">1</span>) = A_m(<span class="number">4</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">% Sampling.</span></span><br><span class="line">[t,x] = Sampling(T,fs,m);</span><br><span class="line"><span class="comment">% Carrier wave.</span></span><br><span class="line">carrier = <span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*fc*t);</span><br><span class="line"><span class="comment">% ASK modulation.</span></span><br><span class="line">u_m=gT*x.*carrier;</span><br><span class="line"><span class="comment">% T2F.</span></span><br><span class="line">[sf,U_m]=T2F(t,u_m);</span><br><span class="line"> </span><br><span class="line"><span class="comment">% Plotting commands follow.</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,u_m);</span><br><span class="line">title(<span class="string">'Time domain'</span>)</span><br><span class="line">xlabel(<span class="string">'t/s'</span>)</span><br><span class="line">ylabel(<span class="string">'u\_m(t)'</span>)</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>);</span><br><span class="line"><span class="built_in">plot</span>(sf,<span class="built_in">abs</span>(U_m));</span><br><span class="line">title(<span class="string">'Frequency domain'</span>)</span><br><span class="line">xlabel(<span class="string">'f/Hz'</span>)</span><br><span class="line">ylabel(<span class="string">'U\_m'</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">%% Task(2)</span></span><br><span class="line"><span class="comment">% Give the average energy per symbol and average energy per bit.</span></span><br><span class="line">Eav = sum(A_m.^<span class="number">2</span>)/<span class="number">4</span>     <span class="comment">% Average energy per symbol.</span></span><br><span class="line">Eb = Eav/<span class="number">2</span>              <span class="comment">% Average energy per bit.</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">%% Task(3)</span></span><br><span class="line"><span class="comment">% SER.</span></span><br><span class="line"> </span><br><span class="line">SNRindB=<span class="number">0</span>:<span class="number">2</span>:<span class="number">8</span>;          </span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">length</span>(SNRindB)</span><br><span class="line">  <span class="comment">% Simulated error rate .</span></span><br><span class="line">  smld_err_prb(<span class="built_in">i</span>)=smldpe(SNRindB(<span class="built_in">i</span>));     </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="built_in">length</span>(SNRindB)</span><br><span class="line">  <span class="comment">% Signal-to-noise ratio.</span></span><br><span class="line">  SNR_per_bit=<span class="built_in">exp</span>(SNRindB(<span class="built_in">i</span>)*<span class="built_in">log</span>(<span class="number">10</span>)/<span class="number">10</span>);  </span><br><span class="line">  <span class="comment">% Theoretical error rate.</span></span><br><span class="line">  theo_err_prb(<span class="built_in">i</span>)=(<span class="number">3</span>/<span class="number">2</span>)*Qfunct(<span class="built_in">sqrt</span>((<span class="number">4</span>/<span class="number">5</span>)*SNR_per_bit));  </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% Plotting commands follow.</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line">semilogy(SNRindB,smld_err_prb,<span class="string">'*'</span>);</span><br><span class="line"><span class="built_in">hold</span></span><br><span class="line">semilogy(SNRindB,theo_err_prb);</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>Sampling.m</li>
</ul>
<figure class="highlight matlab"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[T,Samp_Sig]</span>=<span class="title">Sampling</span><span class="params">(t,Fs,sig)</span> </span></span><br><span class="line"><span class="comment">% Fucntion Name:Sampling </span></span><br><span class="line"><span class="comment">%Input: Tb,Fs:sig OutPut:Samp_Sig </span></span><br><span class="line"><span class="comment">%When you call the Function ,u input the tiem for a bit,the </span></span><br><span class="line"><span class="comment">%Sampling rate and the source signal,then output the Samplint Signal.</span></span><br><span class="line">Ts=<span class="number">1</span>/Fs;</span><br><span class="line">Sig=sig;</span><br><span class="line">len=<span class="built_in">length</span>(Sig);</span><br><span class="line">T=<span class="number">0</span>:Ts:len*t-Ts;</span><br><span class="line">Samp_Sig=T; </span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">0</span>:<span class="number">1</span>:len<span class="number">-1</span></span><br><span class="line">    <span class="keyword">for</span> <span class="built_in">j</span>=<span class="number">1</span>:<span class="number">1</span>:t/Ts</span><br><span class="line">        Samp_Sig(<span class="built_in">i</span>*t/Ts+<span class="built_in">j</span>)=Sig(<span class="built_in">i</span>+<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">end</span>    </span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>T2T.m</li>
</ul>
<figure class="highlight matlab"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[f,sf]</span>=<span class="title">T2F</span><span class="params">(t,st)</span></span></span><br><span class="line"><span class="comment">%input is time and the signal vectors</span></span><br><span class="line"><span class="comment">%output is freguency and signal spectrum</span></span><br><span class="line"> </span><br><span class="line">dt=t(<span class="number">2</span>)-t(<span class="number">1</span>);</span><br><span class="line">T=t(<span class="keyword">end</span>)-t(<span class="number">1</span>)+dt;</span><br><span class="line">df=<span class="number">1</span>/T;                     <span class="comment">%smapling rate</span></span><br><span class="line">N=<span class="built_in">length</span>(st);</span><br><span class="line"> </span><br><span class="line">f=-N/<span class="number">2</span>*df:df:(N/<span class="number">2</span><span class="number">-1</span>)*df;    <span class="comment">% Frequency sampling point.</span></span><br><span class="line">sf=fft(st);</span><br><span class="line"><span class="comment">% Compensation for time shift</span></span><br><span class="line">sf=T/N*fftshift(sf).*<span class="built_in">exp</span>(-<span class="built_in">j</span>*<span class="number">2</span>*<span class="built_in">pi</span>*f*t(<span class="number">1</span>));   </span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>smldpe.m</li>
</ul>
<figure class="highlight matlab"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[p]</span>=<span class="title">smldpe</span><span class="params">(snr_in_dB)</span></span></span><br><span class="line"><span class="comment">% [p]=smldPe(snr_in_dB)</span></span><br><span class="line"><span class="comment">%       SMLDPE  simulates the probability of error for the given</span></span><br><span class="line"><span class="comment">%           snr_in_dB, signal to noise ratio in dB.</span></span><br><span class="line">d=<span class="number">1</span>;</span><br><span class="line">SNR=<span class="built_in">exp</span>(snr_in_dB*<span class="built_in">log</span>(<span class="number">10</span>)/<span class="number">10</span>);      <span class="comment">% signal to noise ratio per bit</span></span><br><span class="line">sgma=<span class="built_in">sqrt</span>((<span class="number">5</span>*d^<span class="number">2</span>)/(<span class="number">4</span>*SNR));         <span class="comment">% sigma, standard deviation of noise</span></span><br><span class="line">N=<span class="number">10000</span>;                            <span class="comment">% number of symbols being simulated</span></span><br><span class="line"><span class="comment">% generation of the quarternary data source follows</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:N</span><br><span class="line">  temp=<span class="built_in">rand</span>;                        <span class="comment">% a uniform random variable over (0,1)</span></span><br><span class="line">  <span class="keyword">if</span> (temp&lt;<span class="number">0.25</span>)</span><br><span class="line">    dsource(<span class="built_in">i</span>)=<span class="number">1</span>;                   <span class="comment">% with probability 1/4, source output is "00"</span></span><br><span class="line">  <span class="keyword">elseif</span> (temp&lt;<span class="number">0.5</span>)</span><br><span class="line">    dsource(<span class="built_in">i</span>)=<span class="number">2</span>;                   <span class="comment">% with probability 1/4, source output is "01"</span></span><br><span class="line">  <span class="keyword">elseif</span> (temp&lt;<span class="number">0.75</span>)</span><br><span class="line">    dsource(<span class="built_in">i</span>)=<span class="number">3</span>;                   <span class="comment">% with probability 1/4, source output is "11"</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    dsource(<span class="built_in">i</span>)=<span class="number">4</span>;                   <span class="comment">% with probability 1/4, source output is "10"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% detection, and probability of error calculation</span></span><br><span class="line">numoferr=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:N</span><br><span class="line">  <span class="comment">% The matched filter outputs</span></span><br><span class="line">  <span class="keyword">if</span> (dsource(<span class="built_in">i</span>)==<span class="number">1</span>)</span><br><span class="line">    r=<span class="number">-3</span>*d+gngauss(sgma);           <span class="comment">% if the source output is "00"</span></span><br><span class="line">  <span class="keyword">elseif</span> (dsource(<span class="built_in">i</span>)==<span class="number">2</span>)</span><br><span class="line">    r=-d+gngauss(sgma);             <span class="comment">% if the source output is "01"</span></span><br><span class="line">  <span class="keyword">elseif</span> (dsource(<span class="built_in">i</span>)==<span class="number">3</span>)  </span><br><span class="line">    r=d+gngauss(sgma);              <span class="comment">% if the source output is "11"</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    r=<span class="number">3</span>*d+gngauss(sgma);            <span class="comment">% if the source output is "10"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="comment">% detector follows</span></span><br><span class="line">  <span class="keyword">if</span> (r&lt;<span class="number">-2</span>*d)</span><br><span class="line">    decis=<span class="number">1</span>;                        <span class="comment">% decision is "00"</span></span><br><span class="line">  <span class="keyword">elseif</span> (r&lt;<span class="number">0</span>)</span><br><span class="line">    decis=<span class="number">2</span>;                        <span class="comment">% decision is "01"</span></span><br><span class="line">  <span class="keyword">elseif</span> (r&lt;<span class="number">2</span>*d)</span><br><span class="line">    decis=<span class="number">3</span>;                        <span class="comment">% decision is "11"</span></span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    decis=<span class="number">4</span>;                        <span class="comment">% decision is "10"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">if</span> (decis~=dsource(<span class="built_in">i</span>))            <span class="comment">% if it is an error, increase the error counter</span></span><br><span class="line">    numoferr=numoferr+<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">p=numoferr/N;                       <span class="comment">% probability of error </span></span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>gngauss.m</li>
</ul>
<figure class="highlight matlab"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[gsrv1,gsrv2]</span>=<span class="title">gngauss</span><span class="params">(m,sgma)</span></span></span><br><span class="line"><span class="comment">% [gsrv1,gsrv2]=gngauss(m,sgma)</span></span><br><span class="line"><span class="comment">% [gsrv1,gsrv2]=gngauss(sgma)</span></span><br><span class="line"><span class="comment">% [gsrv1,gsrv2]=gngauss</span></span><br><span class="line"><span class="comment">%       GNGAUSS  generates two independent Gaussian random variables with mean</span></span><br><span class="line"><span class="comment">%           m and standard deviation sgma. If one of the input arguments is missing </span></span><br><span class="line"><span class="comment">%           it takes the mean as 0, and the standard deviation as the given parameter.</span></span><br><span class="line"><span class="comment">%           If neither mean nor the variance is given, it generates two standard</span></span><br><span class="line"><span class="comment">%           Gaussian random variables. </span></span><br><span class="line"><span class="keyword">if</span> nargin == <span class="number">0</span>,</span><br><span class="line">  m=<span class="number">0</span>; sgma=<span class="number">1</span>;</span><br><span class="line"><span class="keyword">elseif</span> nargin == <span class="number">1</span>,</span><br><span class="line">  sgma=m; m=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">end</span>;</span><br><span class="line">u=<span class="built_in">rand</span>;                             <span class="comment">% a uniform random variable in (0,1)       </span></span><br><span class="line">z=sgma*(<span class="built_in">sqrt</span>(<span class="number">2</span>*<span class="built_in">log</span>(<span class="number">1</span>/(<span class="number">1</span>-u))));      <span class="comment">% a Rayleigh distributed random variable</span></span><br><span class="line">u=<span class="built_in">rand</span>;                             <span class="comment">% another uniform random variable in (0,1)</span></span><br><span class="line">gsrv1=m+z*<span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*u);</span><br><span class="line">gsrv2=m+z*<span class="built_in">sin</span>(<span class="number">2</span>*<span class="built_in">pi</span>*u);</span><br></pre></td></tr></tbody></table></figure>
<ul>
<li>Qfunct.m</li>
</ul>
<figure class="highlight matlab"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="params">[y]</span>=<span class="title">Qfunct</span><span class="params">(x)</span></span></span><br><span class="line"><span class="comment">% [y]=Qfunct(x)</span></span><br><span class="line"><span class="comment">%       QFUNCT  evaluates the Q-function. </span></span><br><span class="line"><span class="comment">%           y = 1/sqrt(2*pi) * integral from x to inf of exp(-t^2/2) dt.</span></span><br><span class="line"><span class="comment">%           y = (1/2) * erfc(x/sqrt(2)).</span></span><br><span class="line">y=(<span class="number">1</span>/<span class="number">2</span>)*<span class="built_in">erfc</span>(x/<span class="built_in">sqrt</span>(<span class="number">2</span>));</span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h3 id="chart-4ASK-Fig"><a href="#chart-4ASK-Fig" class="headerlink" title=":chart: 4ASK Fig"></a><span class="github-emoji"><span>üíπ</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4b9.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 4ASK Fig</h3><p><img src="https://www.lingzhicheng.cn/usr/file/picture/Matlab/ASK_PSK/Time_domain.png" alt="Message bits in Time domain(4ASK)."></p>
<center><font size="2">Fig.1 Message bits in Time domain(4ASK).</font></center>
<br><br><br>

![Fig.2 Message bits in Frequency domain.][2]
<center><font size="2">Fig.2 Message bits in Frequency domain.</font></center>
<br><br><br>

<div align="center"><img src="https://www.lingzhicheng.cn/usr/file/picture/Matlab/ASK_PSK/lab6_1_Eb.png"></div>
<center><font size="2">Fig.3 The average signal energy per bit.</font></center>
<br><br><br>

![Fig.4 The theoretical SER and simulated SER][4]
<center><font size="2">Fig.4 The theoretical SER and simulated SER</font></center>

<h3 id="grey-question-4ASK-Discussion"><a href="#grey-question-4ASK-Discussion" class="headerlink" title=":grey_question: 4ASK Discussion"></a><span class="github-emoji"><span>‚ùî</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/2754.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 4ASK Discussion</h3><blockquote>
<p>Using carrier wave to transmit information is different from baseband transmission. Carrier-modulated digital transmission moves the frequency of the signal carrying the information to the frequency band of the signal.<br>The baseband signal waveform is multiplied by the sine carrier, and the frequency spectrum of the baseband signal is shifted by an amount of fc, and thus the signal is placed in the bandwidth of the channel.<br>First map the 10-bit learning sequence to a binary number according to the law, and then change the corresponding amplitude according to the 4ASK mapping relationship. After sampling the baseband signal with fs=1000Hz, it is multiplied by the 5Hz sine carrier, and it is found that only the amplitude has occurred in the time domain. Change, the frequency has shifted in the frequency spectrum.</p>
</blockquote>
<h2 id="blue-book-4PSK"><a href="#blue-book-4PSK" class="headerlink" title=":blue_book: 4PSK"></a><span class="github-emoji"><span>üìò</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4d8.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 4PSK</h2><h3 id="u-m-t-sqrt-frac-2E-s-Tcos-2-pi-f-c-t-frac-2-pi-m-4-frac-pi-4-m-1-2-3-‚Ä¶-M"><a href="#u-m-t-sqrt-frac-2E-s-Tcos-2-pi-f-c-t-frac-2-pi-m-4-frac-pi-4-m-1-2-3-‚Ä¶-M" class="headerlink" title="$u{m}(t) = \sqrt \frac {2E{s}}Tcos(2\pi f_{c}t+\frac{2\pi m}4+\frac \pi 4),m=1,2,3,‚Ä¶,M$"></a>$u<em>{m}(t) = \sqrt \frac {2E</em>{s}}Tcos(2\pi f_{c}t+\frac{2\pi m}4+\frac \pi 4),m=1,2,3,‚Ä¶,M$</h3><p>where the average signal energy Es=1, T=1, fc=5Hz, and the constellation diagram is:</p>
<h3 id="s-m-sqrt-E-s-cos-frac-2-pi-m-4-frac-pi-4-sqrt-E-s-sin-frac-2-pi-m-4-frac-pi-4"><a href="#s-m-sqrt-E-s-cos-frac-2-pi-m-4-frac-pi-4-sqrt-E-s-sin-frac-2-pi-m-4-frac-pi-4" class="headerlink" title="$s{m}=(\sqrt{E{s}}cos(\frac{2\pi m}4+\frac \pi 4),\sqrt{E_{s}}sin(\frac{2\pi m}4+\frac \pi 4))$"></a>$s<em>{m}=(\sqrt{E</em>{s}}cos(\frac{2\pi m}4+\frac \pi 4),\sqrt{E_{s}}sin(\frac{2\pi m}4+\frac \pi 4))$</h3><p><em>(1) If the message bits are 11 00 10 00 01, plot the corresponding 4PSK signal in both time and frequency domain, sampling frequency fs=1000Hz.<br>(2) Plot the constellation diagram of the 4PSK experiencing the AWGN channel with N0=0.5. (You can generate a large number of 4PSK signals and noise samples.)<br>(3) Give the BER and SER for N0=0.5, from theoretical calculation and numerical simulation, respectively.</em></p>
<h3 id="memo-4PSK-Code"><a href="#memo-4PSK-Code" class="headerlink" title=":memo: 4PSK Code"></a><span class="github-emoji"><span>üìù</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4dd.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 4PSK Code</h3><ul>
<li>4PSK.m</li>
</ul>
<figure class="highlight matlab"><table><tbody><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">%% Consider the following 4PSK modulation.</span></span><br><span class="line"> </span><br><span class="line">clear;</span><br><span class="line">clc;</span><br><span class="line"> </span><br><span class="line"><span class="comment">%% Task(1)</span></span><br><span class="line"><span class="comment">% Plot the corresponding 4PSK signal.</span></span><br><span class="line">T = <span class="number">1</span>;                  <span class="comment">% Symbol interval.</span></span><br><span class="line">Es = <span class="number">1</span>;                 <span class="comment">% Energy of every symbol.</span></span><br><span class="line">Tb = T/<span class="number">2</span>;               <span class="comment">% Bit interval.</span></span><br><span class="line">m = [<span class="number">0</span>,<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>];          <span class="comment">% Equally spaced.</span></span><br><span class="line">M = <span class="number">4</span>;                  <span class="comment">% 4PSK:M=4</span></span><br><span class="line">fc = <span class="number">5</span>;                 <span class="comment">% Carrier frequency.</span></span><br><span class="line">fs = <span class="number">1000</span>;              <span class="comment">% Sampling frequency.</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">% Message bits.</span></span><br><span class="line">N = <span class="number">5</span>;</span><br><span class="line">Sig = [<span class="number">1</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="number">1</span>];</span><br><span class="line"><span class="comment">% Mapping.</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">2</span>:<span class="built_in">length</span>(Sig)</span><br><span class="line">    <span class="keyword">if</span>(Sig(<span class="built_in">i</span>)==<span class="number">0</span>&amp;&amp;Sig(<span class="built_in">i</span>+<span class="number">1</span>)==<span class="number">0</span>)</span><br><span class="line">        phase_m(<span class="built_in">fix</span>(<span class="built_in">i</span>/<span class="number">2</span>)+<span class="number">1</span>) = m(<span class="number">1</span>);</span><br><span class="line">    <span class="keyword">elseif</span>(Sig(<span class="built_in">i</span>)==<span class="number">0</span>&amp;&amp;Sig(<span class="built_in">i</span>+<span class="number">1</span>)==<span class="number">1</span>)</span><br><span class="line">        phase_m(<span class="built_in">fix</span>(<span class="built_in">i</span>/<span class="number">2</span>)+<span class="number">1</span>) = m(<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">elseif</span>(Sig(<span class="built_in">i</span>)==<span class="number">1</span>&amp;&amp;Sig(<span class="built_in">i</span>+<span class="number">1</span>)==<span class="number">1</span>)</span><br><span class="line">        phase_m(<span class="built_in">fix</span>(<span class="built_in">i</span>/<span class="number">2</span>)+<span class="number">1</span>) = m(<span class="number">3</span>);</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        phase_m(<span class="built_in">fix</span>(<span class="built_in">i</span>/<span class="number">2</span>)+<span class="number">1</span>) = m(<span class="number">4</span>);</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">% Sampling.</span></span><br><span class="line">[t,x] = Sampling(T,fs,phase_m);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">1</span>:N*T*fs</span><br><span class="line">    u_m(<span class="built_in">i</span>) =<span class="built_in">sqrt</span>(<span class="number">2</span>*Es/T)*<span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*fc*<span class="built_in">i</span>/fs+<span class="number">2</span>*<span class="built_in">pi</span>*x(<span class="built_in">i</span>)/<span class="number">4</span>+<span class="built_in">pi</span>/<span class="number">4</span>); </span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% T2F.</span></span><br><span class="line">[sf,U_m]=T2F(t,u_m);</span><br><span class="line"> </span><br><span class="line"><span class="comment">% Plotting commands follow.</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">1</span>)</span><br><span class="line"><span class="built_in">plot</span>(t,u_m);</span><br><span class="line">title(<span class="string">'Time domain'</span>)</span><br><span class="line">xlabel(<span class="string">'t/s'</span>)</span><br><span class="line">ylabel(<span class="string">'u\_m(t)'</span>)</span><br><span class="line"><span class="built_in">figure</span>(<span class="number">2</span>);</span><br><span class="line"><span class="built_in">plot</span>(sf,<span class="built_in">abs</span>(U_m));</span><br><span class="line">title(<span class="string">'Frequency domain'</span>)</span><br><span class="line">xlabel(<span class="string">'f/Hz'</span>)</span><br><span class="line">ylabel(<span class="string">'U\_m'</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">%% Task(2)</span></span><br><span class="line"><span class="comment">% Plot the constellation diagram.</span></span><br><span class="line">N0 = <span class="number">0.5</span>;</span><br><span class="line">nc=<span class="built_in">sqrt</span>(N0/<span class="number">2</span>)*<span class="built_in">randn</span>(<span class="number">5000</span>,<span class="number">1</span>);</span><br><span class="line">ns=<span class="built_in">sqrt</span>(N0/<span class="number">2</span>)*<span class="built_in">randn</span>(<span class="number">5000</span>,<span class="number">1</span>);</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">1</span>:N*T*fs</span><br><span class="line">    Sm_x(<span class="built_in">i</span>) = <span class="built_in">sqrt</span>(Es)*<span class="built_in">cos</span>(<span class="number">2</span>*<span class="built_in">pi</span>*x(<span class="built_in">i</span>)/<span class="number">4</span>+<span class="built_in">pi</span>/<span class="number">4</span>)+nc(<span class="built_in">i</span>);</span><br><span class="line">    Sm_y(<span class="built_in">i</span>) = <span class="built_in">sqrt</span>(Es)*<span class="built_in">sin</span>(<span class="number">2</span>*<span class="built_in">pi</span>*x(<span class="built_in">i</span>)/<span class="number">4</span>+<span class="built_in">pi</span>/<span class="number">4</span>)+ns(<span class="built_in">i</span>);</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">% Plotting commands follow.</span></span><br><span class="line"><span class="built_in">figure</span>(<span class="number">3</span>)</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:<span class="number">1</span>:<span class="number">5000</span></span><br><span class="line">    <span class="keyword">if</span>(x(<span class="built_in">i</span>)==<span class="number">0</span>)</span><br><span class="line">        <span class="built_in">plot</span>(Sm_x(<span class="built_in">i</span>),Sm_y(<span class="built_in">i</span>),<span class="string">'r*'</span>)</span><br><span class="line">        <span class="built_in">hold</span> on;</span><br><span class="line">    <span class="keyword">elseif</span>(x(<span class="built_in">i</span>)==<span class="number">1</span>)</span><br><span class="line">        <span class="built_in">plot</span>(Sm_x(<span class="built_in">i</span>),Sm_y(<span class="built_in">i</span>),<span class="string">'g+'</span>)</span><br><span class="line">        <span class="built_in">hold</span> on;</span><br><span class="line">    <span class="keyword">elseif</span>(x(<span class="built_in">i</span>)==<span class="number">2</span>)</span><br><span class="line">        <span class="built_in">plot</span>(Sm_x(<span class="built_in">i</span>),Sm_y(<span class="built_in">i</span>),<span class="string">'b.'</span>)</span><br><span class="line">        <span class="built_in">hold</span> on;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">        <span class="built_in">plot</span>(Sm_x(<span class="built_in">i</span>),Sm_y(<span class="built_in">i</span>),<span class="string">'c.'</span>)</span><br><span class="line">        <span class="built_in">hold</span> on;</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">    axis square</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">title(<span class="string">'The constellation diagram of the 4PSK'</span>)</span><br><span class="line"> </span><br><span class="line"><span class="comment">%% Task(3)</span></span><br><span class="line"><span class="comment">% BER and SER.</span></span><br><span class="line"> </span><br><span class="line">N=<span class="number">100000</span>;</span><br><span class="line">Eb=Es/<span class="number">2</span>;</span><br><span class="line">SNR = Eb/N0;</span><br><span class="line">sgma=<span class="built_in">sqrt</span>(Es/SNR/<span class="number">4</span>);            <span class="comment">% noise variance</span></span><br><span class="line"><span class="comment">% The signal mapping.</span></span><br><span class="line">s00=[<span class="number">1</span> <span class="number">1</span>]\<span class="built_in">sqrt</span>(<span class="number">2</span>);</span><br><span class="line">s01=[<span class="number">-1</span> <span class="number">1</span>]\<span class="built_in">sqrt</span>(<span class="number">2</span>);</span><br><span class="line">s11=[<span class="number">-1</span> <span class="number">-1</span>]\<span class="built_in">sqrt</span>(<span class="number">2</span>);</span><br><span class="line">s10=[<span class="number">1</span> <span class="number">-1</span>]\<span class="built_in">sqrt</span>(<span class="number">2</span>);</span><br><span class="line"><span class="comment">% Generation of the data source.</span></span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:N</span><br><span class="line">  temp=<span class="built_in">rand</span>;                <span class="comment">% a uniform random variable between 0 and 1</span></span><br><span class="line">  <span class="keyword">if</span> (temp&lt;<span class="number">0.25</span>)            <span class="comment">% With probability 1/4, source output is "00."</span></span><br><span class="line">    dsource1(<span class="built_in">i</span>)=<span class="number">0</span>;</span><br><span class="line">    dsource2(<span class="built_in">i</span>)=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">elseif</span> (temp&lt;<span class="number">0.5</span>)         <span class="comment">% With probability 1/4, source output is "01."</span></span><br><span class="line">    dsource1(<span class="built_in">i</span>)=<span class="number">0</span>;</span><br><span class="line">    dsource2(<span class="built_in">i</span>)=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">elseif</span> (temp&lt;<span class="number">0.75</span>)        <span class="comment">% With probability 1/4, source output is "11."</span></span><br><span class="line">    dsource1(<span class="built_in">i</span>)=<span class="number">1</span>;  </span><br><span class="line">    dsource2(<span class="built_in">i</span>)=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">else</span>                      <span class="comment">% With probability 1/4, source output is "10."</span></span><br><span class="line">    dsource1(<span class="built_in">i</span>)=<span class="number">1</span>;</span><br><span class="line">    dsource2(<span class="built_in">i</span>)=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% Detection and the probability of error calculation.</span></span><br><span class="line">numofsymbolerror=<span class="number">0</span>;</span><br><span class="line">numofbiterror=<span class="number">0</span>;</span><br><span class="line"><span class="keyword">for</span> <span class="built_in">i</span>=<span class="number">1</span>:N</span><br><span class="line">  <span class="comment">% The received signal at the detector, for the ith symbol, is:</span></span><br><span class="line">  n(<span class="number">1</span>)=gngauss(sgma);         </span><br><span class="line">  n(<span class="number">2</span>)=gngauss(sgma);</span><br><span class="line">  <span class="keyword">if</span> ((dsource1(<span class="built_in">i</span>)==<span class="number">0</span>) &amp;&amp; (dsource2(<span class="built_in">i</span>)==<span class="number">0</span>))</span><br><span class="line">    r=s00+n;</span><br><span class="line">  <span class="keyword">elseif</span> ((dsource1(<span class="built_in">i</span>)==<span class="number">0</span>) &amp;&amp; (dsource2(<span class="built_in">i</span>)==<span class="number">1</span>))</span><br><span class="line">    r=s01+n;</span><br><span class="line">  <span class="keyword">elseif</span> ((dsource1(<span class="built_in">i</span>)==<span class="number">1</span>) &amp;&amp; (dsource2(<span class="built_in">i</span>)==<span class="number">1</span>))</span><br><span class="line">    r=s11+n;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    r=s10+n;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="comment">% The correlation metrics are computed below.</span></span><br><span class="line">  c00=<span class="built_in">dot</span>(r,s00);</span><br><span class="line">  c01=<span class="built_in">dot</span>(r,s01);</span><br><span class="line">  c11=<span class="built_in">dot</span>(r,s11);</span><br><span class="line">  c10=<span class="built_in">dot</span>(r,s10);</span><br><span class="line">  <span class="comment">% The decision on the ith symbol is made next.</span></span><br><span class="line">  c_max=<span class="built_in">max</span>([c00 c01 c11 c10]);</span><br><span class="line">  <span class="keyword">if</span> (c00==c_max)</span><br><span class="line">    decis1=<span class="number">0</span>; decis2=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">elseif</span> (c01==c_max)</span><br><span class="line">    decis1=<span class="number">0</span>; decis2=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">elseif</span> (c11==c_max)</span><br><span class="line">    decis1=<span class="number">1</span>; decis2=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">else</span></span><br><span class="line">    decis1=<span class="number">1</span>; decis2=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="comment">% Increment the error counter, if the decision is not correct.</span></span><br><span class="line">  symbolerror=<span class="number">0</span>;</span><br><span class="line">  <span class="keyword">if</span> (decis1~=dsource1(<span class="built_in">i</span>))</span><br><span class="line">    numofbiterror=numofbiterror+<span class="number">1</span>;</span><br><span class="line">    symbolerror=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">if</span> (decis2~=dsource2(<span class="built_in">i</span>))</span><br><span class="line">    numofbiterror=numofbiterror+<span class="number">1</span>;</span><br><span class="line">    symbolerror=<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">if</span> (symbolerror==<span class="number">1</span>)</span><br><span class="line">    numofsymbolerror = numofsymbolerror+<span class="number">1</span>;</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"><span class="comment">% Since there are totally N symbols.</span></span><br><span class="line">ps=numofsymbolerror/N</span><br><span class="line"><span class="comment">% Since 2N bits are transmitted.</span></span><br><span class="line">pb=numofbiterror/(<span class="number">2</span>*N)</span><br><span class="line"> </span><br><span class="line">theo_err_prb=Qfunct(<span class="built_in">sqrt</span>(<span class="number">2</span>*SNR))    <span class="comment">% Theoretical bit-error rate.</span></span><br><span class="line">theo_err_sym=theo_err_prb*<span class="number">2</span>         <span class="comment">% Theoretical symbol-error rate.</span></span><br><span class="line"></span><br></pre></td></tr></tbody></table></figure>
<h3 id="chart-4PSK-Fig"><a href="#chart-4PSK-Fig" class="headerlink" title=":chart: 4PSK Fig"></a><span class="github-emoji"><span>üíπ</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/1f4b9.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 4PSK Fig</h3><p><img src="https://www.lingzhicheng.cn/usr/file/picture/Matlab/ASK_PSK/4PSK_Time_domain.png" alt="Fig.5 Message bits in Time domain(4PSK)."></p>
<center><font size="2">Fig.5 Message bits in Time domain(4PSK).</font></center>
<br><br><br>

![Fig.6 Message bits in Frequency domain(4PSK).][6]
<center><font size="2">Fig.6 Message bits in Frequency domain(4PSK).</font></center>
<br><br><br>

![Fig.7 The constellation diagram of the 4PSK.][7]
<center><font size="2">Fig.7 The constellation diagram of the 4PSK.</font></center>
<br><br><br>

<div align="center"><img src="https://www.lingzhicheng.cn/usr/file/picture/Matlab/ASK_PSK/lab6_2_theoretical_calculation_and_numerical_simulation.png"></div>
<center><font size="2">Fig.8 BER and SER(theoretical calculation and numerical simulation).</font></center>

<h3 id="grey-question-4PSK-Discussion"><a href="#grey-question-4PSK-Discussion" class="headerlink" title=":grey_question: 4PSK Discussion"></a><span class="github-emoji"><span>‚ùî</span><img src="https://github.githubassets.com/images/icons/emoji/unicode/2754.png?v8" aria-hidden="true" onerror="this.parent.classList.add('github-emoji-fallback')"></span> 4PSK Discussion</h3><blockquote>
<p>In carrier phase modulation, the signal to be transmitted through a communication channel is embedded in the phase of the carrier, and the information sequence is binary-coded and mapped to the corresponding phase. Each piece of data corresponds to a phase. The amplitude does not change, but it changes. Initial phase.<br>When the phase of the two bits of information undergoes a sudden change, the time-domain waveform will also undergo a sudden change. The reason is the discontinuity of the phase, which may cause bit errors during demodulation.<br>In the constellation diagram, we can see that the PSK signal will drift due to noise. If the noise is too large, a large number of signals will drift to other phase points, causing an increase in the bit error rate.</p>
</blockquote>
<!-- markdownlint-disable-file MD025 MD033 -->
 
      <!-- reward -->
      
    </div>
    

    <!-- copyright -->
    
    <div class="declare">
      <ul class="post-copyright">
        <li>
          <i class="ri-copyright-line"></i>
          <strong>CopyrightÔºö </strong>
          
          Copyright is owned by the author. For commercial reprints, please contact the author for authorization. For non-commercial reprints, please indicate the source.
          
        </li>
      </ul>
    </div>
    
    <footer class="article-footer">
       
<div class="share-btn">
      <span class="share-sns share-outer">
        <i class="ri-share-forward-line"></i>
        share
      </span>
      <div class="share-wrap">
        <i class="arrow"></i>
        <div class="share-icons">
          
          <a class="weibo share-sns" href="javascript:;" data-type="weibo">
            <i class="ri-weibo-fill"></i>
          </a>
          <a class="weixin share-sns wxFab" href="javascript:;" data-type="weixin">
            <i class="ri-wechat-fill"></i>
          </a>
          <a class="qq share-sns" href="javascript:;" data-type="qq">
            <i class="ri-qq-fill"></i>
          </a>
          <a class="douban share-sns" href="javascript:;" data-type="douban">
            <i class="ri-douban-line"></i>
          </a>
          <!-- <a class="qzone share-sns" href="javascript:;" data-type="qzone">
            <i class="icon icon-qzone"></i>
          </a> -->
          
          <a class="facebook share-sns" href="javascript:;" data-type="facebook">
            <i class="ri-facebook-circle-fill"></i>
          </a>
          <a class="twitter share-sns" href="javascript:;" data-type="twitter">
            <i class="ri-twitter-fill"></i>
          </a>
          <a class="google share-sns" href="javascript:;" data-type="google">
            <i class="ri-google-fill"></i>
          </a>
        </div>
      </div>
</div>

<div class="wx-share-modal">
    <a class="modal-close" href="javascript:;"><i class="ri-close-circle-line"></i></a>
    <p>Êâ´‰∏ÄÊâ´ÔºåÂàÜ‰∫´Âà∞ÂæÆ‰ø°</p>
    <div class="wx-qrcode">
      <img src="//api.qrserver.com/v1/create-qr-code/?size=150x150&data=https://www.lingzhicheng.cn/2021/05/30/ASK%20and%20PSK/" alt="ÂæÆ‰ø°ÂàÜ‰∫´‰∫åÁª¥Á†Å">
    </div>
</div>

<div id="share-mask"></div>  
  <ul class="article-tag-list" itemprop="keywords"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Matlab/" rel="tag">Matlab</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Modulation/" rel="tag">Modulation</a></li></ul>

    </footer>
  </div>

   
  <nav class="article-nav">
    
      <a href="/2021/06/15/F-OFDM%20vs%20OFDM/" class="article-nav-link">
        <strong class="article-nav-caption">Prev post</strong>
        <div class="article-nav-title">
          
            F-OFDM vs OFDM
          
        </div>
      </a>
    
    
      <a href="/2021/05/25/Band-limited%20noiseless%20channel/" class="article-nav-link">
        <strong class="article-nav-caption">Next post</strong>
        <div class="article-nav-title">Band-limited noiseless channel</div>
      </a>
    
  </nav>

  
   
<div class="gitalk" id="gitalk-container"></div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css">


<script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script>


<script src="https://cdn.jsdelivr.net/npm/blueimp-md5@2.10.0/js/md5.min.js"></script>

<script type="text/javascript">
  var gitalk = new Gitalk({
    clientID: 'a1a50124b0c46fa4fab9',
    clientSecret: '4a29dee6f998a9272f57ba07f987ea9eed9da5ec',
    repo: 'blog-comments',
    owner: 'boom1999',
    admin: ['boom1999'],
    // id: location.pathname,      // Ensure uniqueness and length less than 50
    id: md5(location.pathname),
    distractionFreeMode: true,  // Facebook-like distraction free mode
    pagerDirection: 'last',
    proxy: 'https://cors-anywhere.azm.workers.dev/https://github.com/login/oauth/access_token'
  })

  gitalk.render('gitalk-container')
</script>

     
</article>

</section>
      <footer class="footer">
  <div class="outer">
    <ul>
      <li>
        Copyrights &copy;
        2020-2024
        <span class="division">|</span> Zhicheng Ling
      </li>
    </ul>
    <ul>
      <li>
        
          
          
          Power <a href="https://hexo.io" target="_blank">Hexo</a>
          <span class="division">|</span>
          Theme <a href="https://github.com/Shen-Yu/hexo-theme-ayer" target="_blank">Ayer</a>
          
          <span class="division">|</span>
        
          
          <span>
  <span><i class="ri-eye-fill"></i> <span id="busuanzi_value_page_pv"></span></span>
</span>
          
      </li>
    </ul>
    <ul>
      
        <li>
          <a href="http://beian.miit.gov.cn/" target="_black" rel="nofollow">ÊµôICPÂ§á2020044847Âè∑-1</a>
        </li>
        
    </ul>
    <ul>
      
    </ul>
    <ul>
      <li>
        <!-- cnzzÁªüËÆ° -->
        
      </li>
    </ul>
  </div>
</footer>
      <div class="float_btns">
        <div class="totop" id="totop">
  <i class="ri-arrow-up-line"></i>
</div>

<div class="todark" id="todark">
  <i class="ri-moon-line"></i>
</div>

      </div>
    </main>
    <aside class="sidebar on">
      <button class="navbar-toggle"></button>
<nav class="navbar">
  
  <div class="logo">
    <a href="/"><img src="/haisen-side.svg" alt="Haisenberg"></a>
  </div>
  
  <ul class="nav nav-main">
    
    <li class="nav-item">
      <a class="nav-item-link" href="/archives">Archives</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/categories">Categories</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/tags">Tags</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="https://www.pan.lingzhicheng.cn">Pan</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="https://www.gallery.lingzhicheng.cn">Gallery</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" target="_blank" rel="noopener" href="https://www.todo.lingzhicheng.cn">Todo</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/friends">Friends</a>
    </li>
    
    <li class="nav-item">
      <a class="nav-item-link" href="/me">Me</a>
    </li>
    
  </ul>
</nav>
<nav class="navbar navbar-bottom">
  <ul class="nav">
    <li class="nav-item">
      
      <a class="nav-item-link nav-item-search"  title="Search">
        <i class="ri-search-line"></i>
      </a>
      
      
      <a class="nav-item-link" target="_blank" href="/atom.xml" title="RSS Feed">
        <i class="ri-rss-line"></i>
      </a>
      
    </li>
  </ul>
</nav>
<div class="search-form-wrap">
  <div class="local-search local-search-plugin">
  <input type="search" id="local-search-input" class="local-search-input" placeholder="Search...">
  <div id="local-search-result" class="local-search-result"></div>
</div>
</div>
    </aside>
    <script>
      if (window.matchMedia("(max-width: 768px)").matches) {
        document.querySelector('.content').classList.remove('on');
        document.querySelector('.sidebar').classList.remove('on');
      }
    </script>
    <div id="mask"></div>

<!-- #reward -->
<div id="reward">
  <span class="close"><i class="ri-close-line"></i></span>
  <p class="reward-p"><i class="ri-cup-line"></i>ËØ∑ÊàëÂñùÊùØÂíñÂï°Âêß~</p>
  <div class="reward-box">
    
    
  </div>
</div>
    
<script src="/js/jquery-2.0.3.min.js"></script>


<script src="/js/lazyload.min.js"></script>

<!-- Tocbot -->


<script src="/js/tocbot.min.js"></script>

<script>
  tocbot.init({
    tocSelector: '.tocbot',
    contentSelector: '.article-entry',
    headingSelector: 'h1, h2, h3, h4, h5, h6',
    hasInnerContainers: true,
    scrollSmooth: true,
    scrollContainer: 'main',
    positionFixedSelector: '.tocbot',
    positionFixedClass: 'is-position-fixed',
    fixedSidebarOffset: 'auto'
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery-modal@0.9.2/jquery.modal.min.css">
<script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js"></script>

<script src="/dist/main.js"></script>

<!-- ImageViewer -->

<!-- Root element of PhotoSwipe. Must have class pswp. -->
<div class="pswp" tabindex="-1" role="dialog" aria-hidden="true">

    <!-- Background of PhotoSwipe. 
         It's a separate element as animating opacity is faster than rgba(). -->
    <div class="pswp__bg"></div>

    <!-- Slides wrapper with overflow:hidden. -->
    <div class="pswp__scroll-wrap">

        <!-- Container that holds slides. 
            PhotoSwipe keeps only 3 of them in the DOM to save memory.
            Don't modify these 3 pswp__item elements, data is added later on. -->
        <div class="pswp__container">
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
            <div class="pswp__item"></div>
        </div>

        <!-- Default (PhotoSwipeUI_Default) interface on top of sliding area. Can be changed. -->
        <div class="pswp__ui pswp__ui--hidden">

            <div class="pswp__top-bar">

                <!--  Controls are self-explanatory. Order can be changed. -->

                <div class="pswp__counter"></div>

                <button class="pswp__button pswp__button--close" title="Close (Esc)"></button>

                <button class="pswp__button pswp__button--share" style="display:none" title="Share"></button>

                <button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>

                <button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button>

                <!-- Preloader demo http://codepen.io/dimsemenov/pen/yyBWoR -->
                <!-- element will get class pswp__preloader--active when preloader is running -->
                <div class="pswp__preloader">
                    <div class="pswp__preloader__icn">
                        <div class="pswp__preloader__cut">
                            <div class="pswp__preloader__donut"></div>
                        </div>
                    </div>
                </div>
            </div>

            <div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap">
                <div class="pswp__share-tooltip"></div>
            </div>

            <button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)">
            </button>

            <button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)">
            </button>

            <div class="pswp__caption">
                <div class="pswp__caption__center"></div>
            </div>

        </div>

    </div>

</div>

<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css">
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js"></script>

<script>
    function viewer_init() {
        let pswpElement = document.querySelectorAll('.pswp')[0];
        let $imgArr = document.querySelectorAll(('.article-entry img:not(.reward-img)'))

        $imgArr.forEach(($em, i) => {
            $em.onclick = () => {
                // sliderÂ±ïÂºÄÁä∂ÊÄÅ
                // todo: ËøôÊ†∑‰∏çÂ•ΩÔºåÂêéÈù¢ÊîπÊàêÁä∂ÊÄÅ
                if (document.querySelector('.left-col.show')) return
                let items = []
                $imgArr.forEach(($em2, i2) => {
                    let img = $em2.getAttribute('data-idx', i2)
                    let src = $em2.getAttribute('data-target') || $em2.getAttribute('src')
                    let title = $em2.getAttribute('alt')
                    // Ëé∑ÂæóÂéüÂõæÂ∞∫ÂØ∏
                    const image = new Image()
                    image.src = src
                    items.push({
                        src: src,
                        w: image.width || $em2.width,
                        h: image.height || $em2.height,
                        title: title
                    })
                })
                var gallery = new PhotoSwipe(pswpElement, PhotoSwipeUI_Default, items, {
                    index: parseInt(i)
                });
                gallery.init()
            }
        })
    }
    viewer_init()
</script>

<!-- MathJax -->

<script type="text/x-mathjax-config">
  MathJax.Hub.Config({
      tex2jax: {
          inlineMath: [ ['$','$'], ["\\(","\\)"]  ],
          processEscapes: true,
          skipTags: ['script', 'noscript', 'style', 'textarea', 'pre', 'code']
      }
  });

  MathJax.Hub.Queue(function() {
      var all = MathJax.Hub.getAllJax(), i;
      for(i=0; i < all.length; i += 1) {
          all[i].SourceElement().parentNode.className += ' has-jax';
      }
  });
</script>

<script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.6/unpacked/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
<script>
  var ayerConfig = {
    mathjax: true
  }
</script>

<!-- Katex -->

<!-- busuanzi  -->


<script src="/js/busuanzi-2.3.pure.min.js"></script>


<!-- ClickLove -->

<!-- ClickBoom1 -->

<!-- ClickBoom2 -->

<!-- CodeCopy -->


<link rel="stylesheet" href="/css/clipboard.css">

<script src="https://cdn.jsdelivr.net/npm/clipboard@2/dist/clipboard.min.js"></script>
<script>
  function wait(callback, seconds) {
    var timelag = null;
    timelag = window.setTimeout(callback, seconds);
  }
  !function (e, t, a) {
    var initCopyCode = function(){
      var copyHtml = '';
      copyHtml += '<button class="btn-copy" data-clipboard-snippet="">';
      copyHtml += '<i class="ri-file-copy-2-line"></i><span>COPY</span>';
      copyHtml += '</button>';
      $(".highlight .code pre").before(copyHtml);
      $(".article pre code").before(copyHtml);
      var clipboard = new ClipboardJS('.btn-copy', {
        target: function(trigger) {
          return trigger.nextElementSibling;
        }
      });
      clipboard.on('success', function(e) {
        let $btn = $(e.trigger);
        $btn.addClass('copied');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-checkbox-circle-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPIED';
        
        wait(function () { // Á≠âÂæÖ‰∏§ÁßíÈíüÂêéÊÅ¢Â§ç
          $icon.removeClass('ri-checkbox-circle-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
      clipboard.on('error', function(e) {
        e.clearSelection();
        let $btn = $(e.trigger);
        $btn.addClass('copy-failed');
        let $icon = $($btn.find('i'));
        $icon.removeClass('ri-file-copy-2-line');
        $icon.addClass('ri-time-line');
        let $span = $($btn.find('span'));
        $span[0].innerText = 'COPY FAILED';
        
        wait(function () { // Á≠âÂæÖ‰∏§ÁßíÈíüÂêéÊÅ¢Â§ç
          $icon.removeClass('ri-time-line');
          $icon.addClass('ri-file-copy-2-line');
          $span[0].innerText = 'COPY';
        }, 2000);
      });
    }
    initCopyCode();
  }(window, document);
</script>


<!-- CanvasBackground -->

<!-- Graphiz -->

  <script src='https://cdnjs.cloudflare.com/ajax/libs/viz.js/1.7.1/viz.js'></script>
  <script>
    String.prototype.replaceAll = function(search, replacement) {
      var target = this;
      return target.split(search).join(replacement);
    };

    let vizObjects = document.querySelectorAll('.graphviz')

    for (let item of vizObjects) {
      let svg = undefined
      try {
        svg = Viz(item.textContent.replaceAll('‚Äì', '--'), 'svg')
      } catch(e) {
        svg = `<pre class="error">${e}</pre>`
      }
      item.outerHTML = svg
    }
  </script>


    
  </div>
  <script>(function(w,d, s, id) {if(typeof(w.webpushr)!=='undefined') return;w.webpushr=w.webpushr||function(){(w.webpushr.q=w.webpushr.q||[]).push(arguments)};var js, fjs = d.getElementsByTagName(s)[0];js = d.createElement(s); js.id = id;js.async=1;js.src = "https://cdn.webpushr.com/app.min.js";
  fjs.parentNode.appendChild(js);}(window,document, 'script', 'webpushr-jssdk'));
  webpushr('setup',{'key':'BL_sZtV4DqDKkZ48a4va762P0m5ke869W_4yODxaGYAZ59daIX84-6sOrZmGOxsw6bxpwPk5yKCMxalOZl3rqTA' });</script>
<script>(function (w, d, s, id) {
            if (typeof (w.webpushr) !== 'undefined') return; w.webpushr = w.webpushr || function () { (w.webpushr.q = w.webpushr.q || []).push(arguments) }; var js, fjs = d.getElementsByTagName(s)[0]; js = d.createElement(s); js.id = id; js.async = 1; js.src = "https://cdn.webpushr.com/app.min.js";fjs.parentNode.appendChild(js);}(window, document, 'script', 'webpushr-jssdk'));webpushr('setup', { 'key': 'BL_sZtV4DqDKkZ48a4va762P0m5ke869W_4yODxaGYAZ59daIX84-6sOrZmGOxsw6bxpwPk5yKCMxalOZl3rqTA' });</script></body>

</html>
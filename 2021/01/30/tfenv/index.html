<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  
  <title>Haisen</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <meta name="description" content="1.前言：先装python还是先装anaconda2. Anaconda版本选择与下载3. Anaconda安装4. 更换镜像源5. Pycharm使用6. Pycharm虚拟环境介绍7. CUDA与cuDNN8. TensorFlow ##版本## python 3.7.0conda 4.5.11CUDA 11.1Cudatoolkit 11.1.0cuDNN 11.1 v8.0.5tensor">
<meta property="og:type" content="article">
<meta property="og:title" content="Haisen">
<meta property="og:url" content="http://example.com/2021/01/30/tfenv/index.html">
<meta property="og:site_name" content="Haisen">
<meta property="og:description" content="1.前言：先装python还是先装anaconda2. Anaconda版本选择与下载3. Anaconda安装4. 更换镜像源5. Pycharm使用6. Pycharm虚拟环境介绍7. CUDA与cuDNN8. TensorFlow ##版本## python 3.7.0conda 4.5.11CUDA 11.1Cudatoolkit 11.1.0cuDNN 11.1 v8.0.5tensor">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://www.lingzhicheng.cn/usr/file/picture/Python/Anaconda.png">
<meta property="og:image" content="https://www.lingzhicheng.cn/usr/file/picture/Python/Anaconda_tsinghua.png">
<meta property="og:image" content="https://www.lingzhicheng.cn/usr/file/picture/Python/Anaconda_python.png">
<meta property="og:image" content="https://www.lingzhicheng.cn/usr/file/picture/Python/Anaconda_complete.png">
<meta property="og:image" content="https://www.lingzhicheng.cn/usr/file/picture/Python/Anaconda_navigator.png">
<meta property="og:image" content="https://www.lingzhicheng.cn/usr/file/picture/Python/Change_channel.png">
<meta property="og:image" content="https://www.lingzhicheng.cn/usr/file/picture/Python/nvcc%20-V.png">
<meta property="og:image" content="https://www.lingzhicheng.cn/usr/file/picture/Python/CUDA_test0.png">
<meta property="og:image" content="https://www.lingzhicheng.cn/usr/file/picture/Python/CUDA_test1.png">
<meta property="og:image" content="https://www.lingzhicheng.cn/usr/file/picture/Python/Prompt_test.png">
<meta property="og:image" content="https://www.lingzhicheng.cn/usr/file/picture/Python/Pycharm_test0.png">
<meta property="og:image" content="https://www.lingzhicheng.cn/usr/file/picture/Python/Pycharm_test1.png">
<meta property="article:published_time" content="2021-01-30T06:29:46.473Z">
<meta property="article:modified_time" content="2021-01-30T06:44:40.339Z">
<meta property="article:author" content="Zhicheng Ling">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://www.lingzhicheng.cn/usr/file/picture/Python/Anaconda.png">
  
    <link rel="alternate" href="/atom.xml" title="Haisen" type="application/atom+xml">
  
  
    <link rel="shortcut icon" href="/favicon.png">
  
  
    
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/typeface-source-code-pro@0.0.71/index.min.css">

  
  
<link rel="stylesheet" href="/css/style.css">

  
    
<link rel="stylesheet" href="/fancybox/jquery.fancybox.min.css">

  
<meta name="generator" content="Hexo 5.3.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Haisen</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS 订阅"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="搜索"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="搜索"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://example.com"></form>
      </div>
    </div>
  </div>
</header>

      <div class="outer">
        <section id="main"><article id="post-tfenv" class="h-entry article article-type-post" itemprop="blogPost" itemscope itemtype="https://schema.org/BlogPosting">
  <div class="article-meta">
    <a href="/2021/01/30/tfenv/" class="article-date">
  <time class="dt-published" datetime="2021-01-30T06:29:46.473Z" itemprop="datePublished">2021-01-30</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
    <div class="e-content article-entry" itemprop="articleBody">
      
        <h1 id="1-前言：先装python还是先装anaconda"><a href="#1-前言：先装python还是先装anaconda" class="headerlink" title="1.前言：先装python还是先装anaconda"></a>1.前言：先装python还是先装anaconda</h1><h1 id="2-Anaconda版本选择与下载"><a href="#2-Anaconda版本选择与下载" class="headerlink" title="2. Anaconda版本选择与下载"></a>2. Anaconda版本选择与下载</h1><h1 id="3-Anaconda安装"><a href="#3-Anaconda安装" class="headerlink" title="3. Anaconda安装"></a>3. Anaconda安装</h1><h1 id="4-更换镜像源"><a href="#4-更换镜像源" class="headerlink" title="4. 更换镜像源"></a>4. 更换镜像源</h1><h1 id="5-Pycharm使用"><a href="#5-Pycharm使用" class="headerlink" title="5. Pycharm使用"></a>5. Pycharm使用</h1><h1 id="6-Pycharm虚拟环境介绍"><a href="#6-Pycharm虚拟环境介绍" class="headerlink" title="6. Pycharm虚拟环境介绍"></a>6. Pycharm虚拟环境介绍</h1><h1 id="7-CUDA与cuDNN"><a href="#7-CUDA与cuDNN" class="headerlink" title="7. CUDA与cuDNN"></a>7. CUDA与cuDNN</h1><h1 id="8-TensorFlow"><a href="#8-TensorFlow" class="headerlink" title="8. TensorFlow"></a>8. TensorFlow</h1><hr>
<p>##版本##</p>
<h3 id="python-3-7-0"><a href="#python-3-7-0" class="headerlink" title="python 3.7.0"></a>python 3.7.0</h3><h3 id="conda-4-5-11"><a href="#conda-4-5-11" class="headerlink" title="conda 4.5.11"></a>conda 4.5.11</h3><h3 id="CUDA-11-1"><a href="#CUDA-11-1" class="headerlink" title="CUDA 11.1"></a>CUDA 11.1</h3><h3 id="Cudatoolkit-11-1-0"><a href="#Cudatoolkit-11-1-0" class="headerlink" title="Cudatoolkit 11.1.0"></a>Cudatoolkit 11.1.0</h3><h3 id="cuDNN-11-1-v8-0-5"><a href="#cuDNN-11-1-v8-0-5" class="headerlink" title="cuDNN 11.1 v8.0.5"></a>cuDNN 11.1 v8.0.5</h3><h3 id="tensorflow-gpu-2-4-1"><a href="#tensorflow-gpu-2-4-1" class="headerlink" title="tensorflow_gpu-2.4.1"></a>tensorflow_gpu-2.4.1</h3><h3 id="Pycharm-Professional-2020-3-3"><a href="#Pycharm-Professional-2020-3-3" class="headerlink" title="Pycharm Professional 2020.3.3"></a>Pycharm Professional 2020.3.3</h3><hr>
<blockquote>
<p>写在最前面<br>下面列举了一些常见问题，请务必注意</p>
</blockquote>
<ul>
<li>国外源速度慢导致连接断开（请参考下文更换pip源和conda源）</li>
<li>版本对应问题（请勿安装过高版本的Anaconda，会导致python版本过高，Tensorflow不支持，至本文发布为止最高支持到python3.8，Tensorflow_CPU的安装较为简单，故演示了GPU-2.4.1）</li>
</ul>
<p>笔者在开始前已经有了python3.6.8，其实可以直接跳过</p>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.python.org/downloads/">Python Download</a><br>鉴于目前网上教程采用的版本比较混乱，故此次保姆级教程采用了较新的版本并通过测试<br>保姆级教程：尽可能详细的列出具体步骤，但省略了一些作者认为比较简单的操作：如何打开命令行、命令行基本操作、如何使用Pycharm、软件的基本安装流程、环境变量的手动配置等。</p>
<p><strong>如果仍然无法解决您的问题</strong><br>建议1：转身立马退坑，太卷了<br>建议2：<a target="_blank" rel="noopener" href="https://www.google.com.hk/">点击这里</a></p>
</blockquote>
<hr>
<h2 id="1-前言：先装python还是先装anaconda-1"><a href="#1-前言：先装python还是先装anaconda-1" class="headerlink" title="1.前言：先装python还是先装anaconda"></a>1.前言：先装python还是先装anaconda</h2><blockquote>
<p><strong>装anaconda，就不需要单独装python了</strong></p>
</blockquote>
<blockquote>
<p>anaconda 是一个python的发行版，包括了python和很多常见的软件库,和一个包管理器conda，集成了很多关于python科学计算的第三方库，主要是安装方便，而python是一个编译器，如果不使用anaconda，那么安装起来会比较痛苦，各个库之间的依赖性就很难连接的很好。</p>
</blockquote>
<h2 id="2-Anaconda版本选择与下载-1"><a href="#2-Anaconda版本选择与下载-1" class="headerlink" title="2.Anaconda版本选择与下载"></a>2.Anaconda版本选择与下载</h2><p>###方法一###  </p>
<blockquote>
<p><strong>官网下载</strong> <em>不推荐，不会开飞机的话速度慢并且容易断</em><br><a target="_blank" rel="noopener" href="https://www.anaconda.com/products/individual">Anaconda官网</a><br><img src="https://www.lingzhicheng.cn/usr/file/picture/Python/Anaconda.png" alt="Anaconda官网"></p>
</blockquote>
<p>###方法二###  </p>
<blockquote>
<p><strong>国内镜像源</strong> <em>可以用清华源、中科大源……</em><br><a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/anaconda/archive">Anaconda清华源</a><br><img src="https://www.lingzhicheng.cn/usr/file/picture/Python/Anaconda_tsinghua.png" alt="Anaconda清华源"></p>
</blockquote>
<p>###版本选择###<br> <img src="https://www.lingzhicheng.cn/usr/file/picture/Python/Anaconda_python.png" alt="请输入图片描述"></p>
<h2 id="3-Anaconda安装-1"><a href="#3-Anaconda安装-1" class="headerlink" title="3.Anaconda安装"></a>3.Anaconda安装</h2><blockquote>
<p><strong><em>比较容易</em></strong>，next和skip，包括自动添加到环境变量等操作，建议直接装到C盘可以避免一些后续问题，笔者这里选择装到了E://Anaconda3 <strong><em>等待安装完毕即可</em></strong><br>若没有勾选“Add Anaconda to the system Path environment variable”，需要手动添加环境变量，比较简单，此处勾选了所以忽略</p>
</blockquote>
<blockquote>
<p>验证是否安装完成 conda info</p>
</blockquote>
<p><img src="https://www.lingzhicheng.cn/usr/file/picture/Python/Anaconda_complete.png" alt="验证是否安装完成 conda info"></p>
<blockquote>
<p>Anaconda Navigator是否可用</p>
</blockquote>
<p><img src="https://www.lingzhicheng.cn/usr/file/picture/Python/Anaconda_navigator.png" alt="Anaconda Navigator是否可用"></p>
<h2 id="至此，Python-3-7-0-Anaconda3-5-3-1安装完成"><a href="#至此，Python-3-7-0-Anaconda3-5-3-1安装完成" class="headerlink" title="至此，Python 3.7.0 + Anaconda3-5.3.1安装完成"></a>至此，Python 3.7.0 + Anaconda3-5.3.1安装完成</h2><hr>
<h2 id="4-更换镜像源-1"><a href="#4-更换镜像源-1" class="headerlink" title="4.更换镜像源"></a>4.更换镜像源</h2><blockquote>
<p>可以在Anaconda Navigator中的channel直接更换<br>也可以在Anaconda Prompt中更换镜像源</p>
</blockquote>
<pre><code>conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/free/
conda config --add channels https://mirrors.tuna.tsinghua.edu.cn/anaconda/pkgs/main/
conda config --set show_channel_urls yes
</code></pre>
<blockquote>
<p>查看是否已经更换好通道</p>
</blockquote>
<pre><code>conda config --show channels
</code></pre>
<p><img src="https://www.lingzhicheng.cn/usr/file/picture/Python/Change_channel.png" alt="Change_channel"></p>
<h2 id="5-Pycharm使用-1"><a href="#5-Pycharm使用-1" class="headerlink" title="5.Pycharm使用"></a>5.Pycharm使用</h2><blockquote>
<p>Jetbrains全家桶,US $649.00/Year,当然建议使用edu邮箱获取，申请教育版邮箱认证即可（可能需要不定时验证信息），建议安装<strong>Toolbox</strong>方便更新以及使用</p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://www.jetbrains.com/">附上<strong>Jetbrains</strong>链接</a></p>
</blockquote>
<blockquote>
<p>Jetbrains的验证邮件容易出现在e邮的<strong>拦截队列</strong>中，收不到confirm email可以在拦截队列中找到</p>
</blockquote>
<blockquote>
<p>如果比较困难，可以尝试装中文插件 File-&gt;Settings-&gt;Plugins-&gt;Chinese (Simplified) Language Pack EAP  <strong>当然不建议这样使用，汉化的翻译可能存在偏差</strong></p>
</blockquote>
<h2 id="6-Pycharm虚拟环境介绍-1"><a href="#6-Pycharm虚拟环境介绍-1" class="headerlink" title="6. Pycharm虚拟环境介绍"></a>6. Pycharm虚拟环境介绍</h2><blockquote>
<p>Pycharm采用虚拟的环境，配置是可以采用为项目新建Python解释器或者使用原有的环境</p>
</blockquote>
<ol>
<li>Inherit global site-packages<br>继承本地的库，如果需要重复安装第三方库，可以勾上这个</li>
<li>Make available to all projects<br>可以使别的工程项目可以使用此工程的环境<blockquote>
<p>区别在于，创建Virtualenv Environment 或者 Conda Environment<br>若要在服务器上远程运行，配置SSH interpreter，并且在Tools-&gt;Deploment-&gt;Configuration中配置主机即可，后续有机会再详细展开……</p>
</blockquote>
</li>
</ol>
<h2 id="7-CUDA和cuDNN"><a href="#7-CUDA和cuDNN" class="headerlink" title="7. CUDA和cuDNN"></a>7. CUDA和cuDNN</h2><blockquote>
<p>检测目前安装了哪些环境<br>命令行 <code>conda info --envs</code></p>
</blockquote>
<blockquote>
<p>检查目前有哪些版本的python可以安装<br>命令行<code>conda search --full-name python</code></p>
</blockquote>
<blockquote>
<p>检查目前有哪些版本的Tensorflow可以安装<br>命令行<code>conda search --full -name tensorflow</code></p>
</blockquote>
<blockquote>
<p>查看依赖关系<br>命令行<code>conda info tensorflow</code></p>
<p><strong>在这之前，检查Nvidia驱动支持的CUDA版本，此处安装的是Tensorflow2.4.1，需要CUDA11.0或及以上版本</strong><br><a target="_blank" rel="noopener" href="https://tensorflow.google.cn/install/source_windows?hl=cn#gpu">查看Tensorflow和CUDA对应版本</a>（版本一定要对应）<br><code>nvidia-smin</code>命令行查看CUDA Version （当前显卡驱动最高支持的CUDA版本）</p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://developer.nvidia.com/cuda-toolkit-archive">Nvidia官网下载Cudatoolkit</a>（下载速度慢可以复制链接到迅雷下载）<br>一路安装下来即可，安装过程中已经自动添加了环境变量<br>命令行<code>nvcc -V</code>返回CUDA版本信息，如果<strong>nvcc命令无法识别则表示安装失败</strong><br><img src="https://www.lingzhicheng.cn/usr/file/picture/Python/nvcc%20-V.png" alt="CUDA版本信息"></p>
</blockquote>
<blockquote>
<p><a target="_blank" rel="noopener" href="https://developer.nvidia.com/rdp/cudnn-archive">Nvidia官网下载cuDNN</a>（下载速度慢可以复制链接到迅雷下载）<br><em>只要把cuDNN文件复制到CUDA的对应文件夹里就可以，即所谓的插入式设计，cuDNN是CUDA的扩展计算库，不会对CUDA造成其他影响。</em><br>复制后，手动将CUDA相对路径下的/bin和/lib/x64添加到环境变量CUDA_PATH</p>
<p><strong>测试CUDA</strong><br>命令行<code>cd /d C:\Program Files\NVIDIA GPU Computing Toolkit\CUDA\v11.1\extras\demo_suite</code><br>测试<code>deviceQuery.exe</code><br><img src="https://www.lingzhicheng.cn/usr/file/picture/Python/CUDA_test0.png" alt="CUDA_deviceQuery"><br>测试<code>bandwidthTest.exe</code><br><img src="https://www.lingzhicheng.cn/usr/file/picture/Python/CUDA_test1.png" alt="CUDA_bandwidthTest"><br>都返回Result = PASS<br>That’s OK</p>
</blockquote>
<h2 id="8-TensorFlow-1"><a href="#8-TensorFlow-1" class="headerlink" title="8. TensorFlow"></a>8. TensorFlow</h2><p>###8.1 创建环境###</p>
<pre><code>conda create -name tfenv python=3.7.0
</code></pre>
<blockquote>
<p>由于之前已经更换了清华源，由于网络问题造成的错误率大大降低，但仍然可能被中断<br>用<code>conda info --envs</code>检查一下是否装好了tfenv环境</p>
</blockquote>
<p>###8.2 激活环境###</p>
<pre><code>conda activate tfenv
</code></pre>
<blockquote>
<p>退出环境<code>conda activate</code></p>
</blockquote>
<p>###8.3 激活后安装Tensorflow###</p>
<blockquote>
<p>更换tfenv环境的pip源<br><a target="_blank" rel="noopener" href="https://mirrors.tuna.tsinghua.edu.cn/help/pypi/">更换pip清华源参考方法</a><br>    pip install tensorflow-gpu<br>虽然已经换源，但还是可能出现<code>These Packages Do Not Match The Hashes From The Requirements File.</code><br>解决方案：在pip时，添加”–upgrade”参数（<strong>实测有效</strong>）。<br>几分钟后–&gt;<strong>安装成功</strong></p>
</blockquote>
<p>###8.4 激活后测试Tensorflow###</p>
<blockquote>
<p>输出包含GPU信息的日志</p>
</blockquote>
<pre><code>import tensorflow as tf
tf.test.is_gpu_available()
tf.test.gpu_device_name()
</code></pre>
<p><img src="https://www.lingzhicheng.cn/usr/file/picture/Python/Prompt_test.png" alt="Prompt_test"></p>
<p>###8.5 Pycharm测试Tensorflow###</p>
<blockquote>
<p>添加安装有Tensorflow的环境作为工程的python解释器<br><img src="https://www.lingzhicheng.cn/usr/file/picture/Python/Pycharm_test0.png" alt="Anaconda官网.png"></p>
</blockquote>
<pre><code>import tensorflow as tf
tf.compat.v1.disable_eager_execution()
greeting = tf.constant(&#39;Hello Tensorflow!&#39;)
sess = tf.compat.v1.Session()
result = sess.run(greeting)
print(result)
sess.close()
</code></pre>
<p><img src="https://www.lingzhicheng.cn/usr/file/picture/Python/Pycharm_test1.png" alt="Pycharm中测试"></p>
<hr>
<blockquote>
<p>至此所有安装和配置完成，<strong>版本对应</strong>问题非常重要，如果出现装错了版本请尝试<strong>彻底卸载</strong>后重装<br>为了更有针对性，本文采用了较新的版本，请务必在安装前选择<strong>合适的版本</strong><br>如果提示确实dll动态链接库，请尝试手动下载，貌似采用CUDA11.1可能会遇到这种情况，并且有部分人认为11.1中有未知错误并且不推荐使用，但在安装过程中并未发现，或许之后遇到了会继续补充</p>
</blockquote>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://example.com/2021/01/30/tfenv/" data-id="ckkjcae4o0001owvk0p491lmm" data-title="" class="article-share-link">分享</a>
      
      
      
    </footer>
  </div>
  
    
  
</article>


</section>
        
          <aside id="sidebar">
  
    

  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">归档</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2021/01/">一月 2021</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">最新文章</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2021/01/30/tfenv/">(no title)</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      
      &copy; 2021 Zhicheng Ling<br>
      Powered by <a href="https://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>

    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    


<script src="/js/jquery-3.4.1.min.js"></script>



  
<script src="/fancybox/jquery.fancybox.min.js"></script>




<script src="/js/script.js"></script>





  </div>
</body>
</html>